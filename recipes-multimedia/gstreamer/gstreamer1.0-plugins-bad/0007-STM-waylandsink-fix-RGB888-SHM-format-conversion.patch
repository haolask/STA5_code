From bb988d7521096a4d90685a7abe90aa7733fd6381 Mon Sep 17 00:00:00 2001
From: Stephane Danieau <stephane.danieau@st.com>
Date: Mon, 5 Mar 2018 15:49:42 +0100
Subject: [PATCH 07/25] STM: waylandsink: fix RGB888 SHM format conversion

Consider the endianness when converting the RGB888 pixel format.

Signed-off-by: Fabien Dessenne <fabien.dessenne@st.com>

%% original patch: 0007-STM-waylandsink-fix-RGB888-SHM-format-conversion.patch

%% original patch: 0007-STM-waylandsink-fix-RGB888-SHM-format-conversion.patch

%% original patch: 0007-STM-waylandsink-fix-RGB888-SHM-format-conversion.patch

%% original patch: 0007-STM-waylandsink-fix-RGB888-SHM-format-conversion.patch

%% original patch: 0007-STM-waylandsink-fix-RGB888-SHM-format-conversion.patch

%% original patch: 0007-STM-waylandsink-fix-RGB888-SHM-format-conversion.patch

%% original patch: 0007-STM-waylandsink-fix-RGB888-SHM-format-conversion.patch

%% original patch: 0007-STM-waylandsink-fix-RGB888-SHM-format-conversion.patch

diff --git a/ext/wayland/wlvideoformat.c b/ext/wayland/wlvideoformat.c
index 77cfac8..4f81ffc 100644
--- a/ext/wayland/wlvideoformat.c
+++ b/ext/wayland/wlvideoformat.c
@@ -52,6 +52,8 @@ static const wl_ShmVideoFormat shm_formats[] = {
   {WL_SHM_FORMAT_ABGR8888, GST_VIDEO_FORMAT_ABGR},
   {WL_SHM_FORMAT_RGBA8888, GST_VIDEO_FORMAT_RGBA},
   {WL_SHM_FORMAT_BGRA8888, GST_VIDEO_FORMAT_BGRA},
+  {WL_SHM_FORMAT_RGB888, GST_VIDEO_FORMAT_RGB},
+  {WL_SHM_FORMAT_BGR888, GST_VIDEO_FORMAT_BGR},
 #else
   {WL_SHM_FORMAT_XRGB8888, GST_VIDEO_FORMAT_BGRx},
   {WL_SHM_FORMAT_ARGB8888, GST_VIDEO_FORMAT_BGRA},
@@ -61,9 +63,9 @@ static const wl_ShmVideoFormat shm_formats[] = {
   {WL_SHM_FORMAT_ABGR8888, GST_VIDEO_FORMAT_RGBA},
   {WL_SHM_FORMAT_RGBA8888, GST_VIDEO_FORMAT_ABGR},
   {WL_SHM_FORMAT_BGRA8888, GST_VIDEO_FORMAT_ARGB},
+  {WL_SHM_FORMAT_RGB888, GST_VIDEO_FORMAT_BGR},
+  {WL_SHM_FORMAT_BGR888, GST_VIDEO_FORMAT_RGB},
 #endif
-  {WL_SHM_FORMAT_RGB888, GST_VIDEO_FORMAT_RGB},
-  {WL_SHM_FORMAT_BGR888, GST_VIDEO_FORMAT_BGR},
   {WL_SHM_FORMAT_RGB565, GST_VIDEO_FORMAT_RGB16},
   {WL_SHM_FORMAT_BGR565, GST_VIDEO_FORMAT_BGR16},
 
-- 
2.7.4

