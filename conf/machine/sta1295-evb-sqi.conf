#@TYPE: Machine
#@NAME: Accordo5 STA1295 EVB board
#@DESCRIPTION: Machine configuration for Accordo5 STA1295 EVB board with **SQI** only memory
#@NEEDED_BSPLAYERS: meta-toolchain-bare-metal

include conf/machine/include/sta1295-base.inc

IMAGE_FSTYPES ?= "ubifs"

MEMORY_BOOT_DEVICE = "SQI"

# UBIFS default parameters for up to 64MB serial nor flash
MKUBIFS_COMMON_ARGS = "-F -e 65408 -m 8"
MKUBIFS_ARGS = "${MKUBIFS_COMMON_ARGS} -c 1024"
MKUBIFS_BOOTFS_ARGS = "${MKUBIFS_COMMON_ARGS} -c 96"
BLOCK_SIZE = "64"

## FLASHLOADER ##
UBOOT_ENV_CONFIG ?= "${LAYER_PATH}/conf/machine/sta1295-uboot-env-sqi.txt"
FLASHLOADER_CONFIG ?= "${LAYER_PATH}/conf/flashloader/config_sqi_only.txt"

## MEMORY MAPPING ##
MEMORY_MAPPING_CONFIG ?= "${LAYER_PATH}/conf/mapping/sta1295-evb-mem-mapping_512M.xml"

## SQI on EVB is small, only core-image-minimal can fit in. ##
## Adding extra tools to it ##
CORE_IMAGE_EXTRA_INSTALL += "mtd-utils"
CORE_IMAGE_EXTRA_INSTALL += "mem-access"
CORE_IMAGE_EXTRA_INSTALL += "timestamp"

MACHINE_FEATURES += "atf"
MACHINE_FEATURES += "ChainOfTrust"
